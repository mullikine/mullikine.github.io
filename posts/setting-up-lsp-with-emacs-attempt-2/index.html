<!doctype html>
<html lang="en-us">
  <head>
    <title>Setting up LSP with emacs (2nd attempt) // Bodacious Blog</title>
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.59.0-DEV" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="John Doe" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="https://mullikine.github.io/css/main.min.bfa9c7060f6f27290de6ffc084d204f88a8b253d48215ae86ab9400c0c625aa0.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Setting up LSP with emacs (2nd attempt)"/>
<meta name="twitter:description" content="guides used https://www.mortens.dev/blog/emacs-and-the-language-server-protocol/  State of languages with LSP in my own environment    Language LSP Working Fallback working Current user experience     Go ✗ ✓ Great   Python ✓ ✓ Amazing   Rust ✗ ✓ Good   C&#43;&#43; ✓ ✓ clang Great   Haskell ✓ ✓ intero Good    Python The python editing experience in emacs is second to none."/>

    <meta property="og:title" content="Setting up LSP with emacs (2nd attempt)" />
<meta property="og:description" content="guides used https://www.mortens.dev/blog/emacs-and-the-language-server-protocol/  State of languages with LSP in my own environment    Language LSP Working Fallback working Current user experience     Go ✗ ✓ Great   Python ✓ ✓ Amazing   Rust ✗ ✓ Good   C&#43;&#43; ✓ ✓ clang Great   Haskell ✓ ✓ intero Good    Python The python editing experience in emacs is second to none." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mullikine.github.io/posts/setting-up-lsp-with-emacs-attempt-2/" />
<meta property="article:published_time" content="2019-10-30T00:00:00+13:00" />
<meta property="article:modified_time" content="2019-10-30T00:00:00+13:00" /><meta property="og:site_name" content="Bodacious Blog" />


  </head>
  <body>
    <header class="app-header">
      <a href="https://mullikine.github.io"><img class="app-header-avatar" src="http://mullikine.github.io/fievel.png" alt="John Doe" /></a>
      <h1>Bodacious Blog</h1>
      
      <div class="app-header-social">
        
          <a target="_blank" href="https://github.com/mullikine"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg></a>
        
          <a target="_blank" href="https://linkedin.com/in/shane-mulligan-811b942b/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-linkedin">
  <title>linkedin</title>
  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle>
</svg></a>
        
          <a target="_blank" href="https://gitlab.com/mullikine"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-gitlab">
  <title>gitlab</title>
  <path d="M22.65 14.39L12 22.13 1.35 14.39a.84.84 0 0 1-.3-.94l1.22-3.78 2.44-7.51A.42.42 0 0 1 4.82 2a.43.43 0 0 1 .58 0 .42.42 0 0 1 .11.18l2.44 7.49h8.1l2.44-7.51A.42.42 0 0 1 18.6 2a.43.43 0 0 1 .58 0 .42.42 0 0 1 .11.18l2.44 7.51L23 13.45a.84.84 0 0 1-.35.94z"></path>
</svg></a>
        
          <a target="_blank" href="https://twitter.com/mullikine"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter">
  <title>twitter</title>
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
</svg></a>
        
        <a href="https://mullikine.github.io/cv/">CV</a>
      </div>
<div class="highlights">
<a href="https://mullikine.github.io/posts/practical-macros-in-racket-and-how-to-work-with-them/">Practical macros in Racket</a>
<br />
<a href="https://mullikine.github.io/posts/github-search-with-bigquery/">Searching GitHub with BigQuery</a>

<br />
<a href="https://mullikine.github.io/posts/arbitrary-interpreters-for-babel/">Arbitrary interpreters for Babel</a>
<br />
<a href="https://mullikine.github.io/posts/review-of-the-illustrated-transformer/">The Illustrated Transformer</a>
<br />
<a href="https://mullikine.github.io/glossary.html">Glossary A-Z (70 topics)</a>
<br />
<a href="https://mullikine.github.io/codelingo-vs-linters/summary/">CodeLingo vs Linters</a>
<br />
<div class="taglist">

<a class="tag" href="https://mullikine.github.io/tags/gpt-2/">GPT-2</a>
<a class="tag" href="https://mullikine.github.io/tags/nlp/">NLP</a>
<a class="tag" href="https://mullikine.github.io/tags/emacs/">emacs</a>
<a class="tag" href="https://mullikine.github.io/tags/elisp/">elisp</a>
<a class="tag" href="https://mullikine.github.io/tags/racket/">racket</a>
<a class="tag" href="https://mullikine.github.io/tags/haskell/">haskell</a>
<a class="tag" href="https://mullikine.github.io/tags/biosemiotics/">biosemiotics</a>
<a class="tag" href="https://mullikine.github.io/tags/ir/">IR</a>
<a class="tag" href="https://mullikine.github.io/tags/games/">games</a>
<a class="tag" href="https://mullikine.github.io/tags/info/">information theory</a>
<a class="tag" href="https://mullikine.github.io/tags/probability/">probability</a>
<a class="tag" href="https://mullikine.github.io/tags/problog/">problog</a>
<a class="tag" href="https://mullikine.github.io/tags/bash/">bash</a>
<a class="tag" href="https://mullikine.github.io/tags/gcp/">GCP</a>
<a class="tag" href="https://mullikine.github.io/tags/github/">github</a>
<a class="tag" href="https://mullikine.github.io/tags/parsers/">parsers</a>
<a class="tag" href="https://mullikine.github.io/tags/rust/">rust</a>
<a class="tag" href="https://mullikine.github.io/tags/cpp/">c++</a>
<a class="tag" href="https://mullikine.github.io/tags/transformer/">transformer</a>
<a class="tag" href="https://mullikine.github.io/tags/kaggle/">kaggle</a>
<a class="tag" href="https://mullikine.github.io/tags/dl/">deep learning</a>
<a class="tag" href="https://mullikine.github.io/tags/dsls/">DSLs</a>
<a class="tag" href="https://mullikine.github.io/tags/df/">dwarf fortress</a>
<a class="tag" href="https://mullikine.github.io/tags/spacy/">spacy</a>
<a class="tag" href="https://mullikine.github.io/tags/latex/">latex</a>
<a class="tag" href="https://mullikine.github.io/tags/graphviz/">graphviz</a>
<a class="tag" href="https://mullikine.github.io/tags/python/">python</a>
<a class="tag" href="https://mullikine.github.io/tags/golang/">golang</a>
<a class="tag" href="https://mullikine.github.io/tags/codelingo/">codelingo</a>
<a class="tag" href="https://mullikine.github.io/tags/math/">math</a>
<a class="tag" href="https://mullikine.github.io/tags/review/">review</a>
<a class="tag" href="https://mullikine.github.io/tags/codegen/">code-gen</a></div>
<a class="tag" href="https://mullikine.github.io/tags/automation/">automation</a></div>
</div>
<div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Setting up LSP with emacs (2nd attempt)</h1>
      <div class="post-meta">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Oct 30, 2019
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          4 min read
        </div><div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line>
</svg>
          <a class="tag" href="https://mullikine.github.io/tags/emacs/">emacs</a><a class="tag" href="http://mullikine.github.io/tags/lsp/">LSP</a><a class="tag" href="http://mullikine.github.io/tags/cpp/">cpp</a><a class="tag" href="http://mullikine.github.io/tags/rust/">rust</a><a class="tag" href="http://mullikine.github.io/tags/python/">python</a></div></div>
    </header>
    

<link rel="stylesheet" type="text/css" href="https://mullikine.github.io/css/magit.css"/>

<script src="https://mullikine.github.io/js/mathjax-config.js"></script>
 
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_HTML"></script>


    <div class="post-content">
      

<dl>
<dt>guides used</dt>
<dd><a href="https://www.mortens.dev/blog/emacs-and-the-language-server-protocol/">https://www.mortens.dev/blog/emacs-and-the-language-server-protocol/</a></dd>
</dl>

<hr />

<h2 id="state-of-languages-with-lsp-in-my-own-environment">State of languages with LSP in my own environment</h2>

<table>
<thead>
<tr>
<th>Language</th>
<th>LSP Working</th>
<th>Fallback working</th>
<th>Current user experience</th>
</tr>
</thead>

<tbody>
<tr>
<td>Go</td>
<td>✗</td>
<td>✓</td>
<td>Great</td>
</tr>

<tr>
<td>Python</td>
<td>✓</td>
<td>✓</td>
<td>Amazing</td>
</tr>

<tr>
<td>Rust</td>
<td>✗</td>
<td>✓</td>
<td>Good</td>
</tr>

<tr>
<td>C++</td>
<td>✓</td>
<td>✓ clang</td>
<td>Great</td>
</tr>

<tr>
<td>Haskell</td>
<td>✓</td>
<td>✓ intero</td>
<td>Good</td>
</tr>
</tbody>
</table>

<h3 id="python">Python</h3>

<p>The python editing experience in emacs is second to none.</p>

<p><a href="https://asciinema.org/a/0dgW1uTEap2ROGDvEsjlXwi3J" target="_blank"><img src="https://asciinema.org/a/0dgW1uTEap2ROGDvEsjlXwi3J.svg" /></a></p>

<h3 id="go">Go</h3>

<h4 id="i-m-getting-an-error">I&rsquo;m getting an error</h4>

<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">LSP :: GetAST: unable to check package for ...: could not determine GOARCH and Go compiler</code></pre></td></tr></table>
</div>
</div>

<p><a href="https://asciinema.org/a/1H758E1j9QJ5q7F6vG9caDVGy" target="_blank"><img src="https://asciinema.org/a/1H758E1j9QJ5q7F6vG9caDVGy.svg" /></a></p>

<h3 id="c">C++</h3>

<p>LSP for C++ works quite well.</p>

<p><a href="https://asciinema.org/a/ALx6GoyRapW0MrHZbvU9M8z95" target="_blank"><img src="https://asciinema.org/a/ALx6GoyRapW0MrHZbvU9M8z95.svg" /></a></p>

<h4 id="i-need-to-figure-out-how-to-get-auto-completion-after">I need to figure out how to get auto-completion after <code>-&gt;</code></h4>

<p>This is not an LSP problem but a problem with <code>company-mode</code>.</p>

<p>It should be possible to accomplish.</p>

<h3 id="c-and-clang"><code>c++</code> and <code>clang</code></h3>

<h4 id="do-not-use-cquery-dot-apparently-clangd-is-better">Do not use <code>cquery</code>. Apparently, <code>clangd</code> is better</h4>

<p><a href="https://github.com/cquery-project/cquery">https://github.com/cquery-project/cquery</a></p>

<h4 id="clangd"><code>clangd</code></h4>

<p><a href="http://releases.llvm.org/download.html">http://releases.llvm.org/download.html</a></p>

<p><span class="underline"><strong>Download and install the pre-built binary</strong></span></p>

<p><span class="underline"><strong>Write some elisp</strong></span></p>

<p>Without <code>-background-index</code>, it will only keep
an in-memory index of the files that are
active in Emacs buffers, but to be able to
find references and symbols in any project
file the background index is recommended. It
is placed at the project root as the “.clangd”
folder.</p>

<dl>
<dt><code>compile_commands.json</code></dt>
<dd><p>Clangd tries to locate the
    “compile_commands.json” file in the root of
    the project, so it’s useful to make a symlink in the
    project root and to where it’s located in
    a build folder.</p>

<p>Most build tools can output
“compile_commands.json”.</p>

<p>In CMake you write:</p>

<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cmake" data-lang="cmake"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cmake" data-lang="cmake">    set(<span style="color:#e6db74">CMAKE_EXPORT_COMPILE_COMMANDS</span> <span style="color:#e6db74">ON</span>)<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    </code></pre></td></tr></table>
</div>
</div></dd>
</dl>

<h2 id="disable-lsp-mode-auto-formatting">Disable <code>lsp-mode</code> auto-formatting</h2>

<p><code>lsp-mode</code> autoformats when the buffer is changed.</p>

<p>It was breaking <code>C++</code>.</p>

<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(add-hook <span style="color:#e6db74">&#39;lsp--managed-mode-hook</span> (lambda <span style="color:#66d9ef">nil</span> (interactive) (remove-hook <span style="color:#e6db74">&#39;post-self-insert-hook</span> <span style="color:#e6db74">&#39;lsp--on-self-insert</span> <span style="color:#66d9ef">t</span>)))</code></pre></td></tr></table>
</div>
</div>

<h2 id="lsp-ui-uses-return-rather-than-ret-when-setting-bindings"><code>lsp-ui</code> uses <code>&lt;return&gt;</code> rather than <code>RET</code> when setting bindings</h2>

<p>Set <code>RET</code> too. I want all <code>&lt;return&gt;</code> bindings
to be <code>RET</code> bindings everywhere in my
<code>emacs.d</code>.</p>

<p>On the surface level it might appear to work
fine but you might scratch your head when
things go wrong wondering why prefix keys are
not working or bindings are not being
overridden, etc.</p>

<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(<span style="color:#a6e22e">define-key</span> lsp-ui-imenu-mode-map (kbd <span style="color:#e6db74">&#34;&lt;return&gt;&#34;</span>) <span style="color:#e6db74">&#39;lsp-ui-imenu--view</span>)
(<span style="color:#a6e22e">define-key</span> lsp-ui-imenu-mode-map (kbd <span style="color:#e6db74">&#34;RET&#34;</span>) <span style="color:#e6db74">&#39;lsp-ui-imenu--view</span>)

(<span style="color:#a6e22e">define-key</span> lsp-ui-flycheck-list-mode-map (kbd <span style="color:#e6db74">&#34;&lt;M-RET&gt;&#34;</span>) <span style="color:#e6db74">&#39;lsp-ui-flycheck-list--visit</span>)
(<span style="color:#a6e22e">define-key</span> lsp-ui-flycheck-list-mode-map (kbd <span style="color:#e6db74">&#34;RET&#34;</span>) <span style="color:#e6db74">&#39;lsp-ui-flycheck-list--view</span>)</code></pre></td></tr></table>
</div>
</div>

<h2 id="lsp-peek-would-close-when-i-hit-pgup-or-pgdown"><code>lsp-peek</code> would close when I hit <code>PgUp</code> or <code>PgDown</code></h2>

<p>Set these to make the keys do something useful.</p>

<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(<span style="color:#a6e22e">define-key</span> lsp-ui-peek-mode-map (kbd <span style="color:#e6db74">&#34;&lt;prior&gt;&#34;</span>) <span style="color:#a6e22e">#&#39;</span>lsp-ui-peek--select-prev-file)
(<span style="color:#a6e22e">define-key</span> lsp-ui-peek-mode-map (kbd <span style="color:#e6db74">&#34;&lt;next&gt;&#34;</span>) <span style="color:#a6e22e">#&#39;</span>lsp-ui-peek--select-next-file)</code></pre></td></tr></table>
</div>
</div>

<h2 id="for-sanity-group-all-the-custom-config-together">For sanity, group all the <code>custom</code> config together</h2>

<p>They were being set in different <code>use-package</code> blocks.</p>

<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(use-package lsp-mode
  :custom
  <span style="color:#75715e">;; ...</span>
  )</code></pre></td></tr></table>
</div>
</div>

<p>Some of these switches toggle various UI
features.</p>

<p>If it&rsquo;s tucked away inside
an automatically generated <code>custom-set-
variables</code> somewhere, this could be confusing.</p>

<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(custom-set-variables
 <span style="color:#75715e">;; debug</span>
 <span style="color:#f92672">&#39;</span>(lsp-print-io <span style="color:#66d9ef">t</span>)
 <span style="color:#f92672">&#39;</span>(lsp-trace <span style="color:#66d9ef">t</span>)
 <span style="color:#f92672">&#39;</span>(lsp-print-performance <span style="color:#66d9ef">t</span>)

 <span style="color:#75715e">;; general</span>
 <span style="color:#f92672">&#39;</span>(lsp-auto-guess-root <span style="color:#66d9ef">t</span>)
 <span style="color:#f92672">&#39;</span>(lsp-document-sync-method <span style="color:#e6db74">&#39;incremental</span>) <span style="color:#75715e">;; none, full, incremental, or nil</span>
 <span style="color:#f92672">&#39;</span>(lsp-response-timeout <span style="color:#ae81ff">10</span>)

 <span style="color:#75715e">;; (lsp-prefer-flymake t)</span>
 <span style="color:#f92672">&#39;</span>(lsp-prefer-flymake <span style="color:#66d9ef">nil</span>) <span style="color:#75715e">;; t(flymake), nil(lsp-ui), or :none</span>
 <span style="color:#75715e">;; flymake is shit. do not use it</span>

 <span style="color:#75715e">;; go-client</span>
 <span style="color:#f92672">&#39;</span>(lsp-clients-go-server-args <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;--cache-style=always&#34;</span> <span style="color:#e6db74">&#34;--diagnostics-style=onsave&#34;</span> <span style="color:#e6db74">&#34;--format-style=goimports&#34;</span>))

 <span style="color:#f92672">&#39;</span>(company-lsp-cache-candidates <span style="color:#66d9ef">t</span>) <span style="color:#75715e">;; auto, t(always using a cache), or nil</span>
 <span style="color:#f92672">&#39;</span>(company-lsp-async <span style="color:#66d9ef">t</span>)
 <span style="color:#f92672">&#39;</span>(company-lsp-enable-recompletion <span style="color:#66d9ef">t</span>)
 <span style="color:#f92672">&#39;</span>(company-lsp-enable-snippet <span style="color:#66d9ef">t</span>)

                                        <span style="color:#75715e">;top right docs</span>
 <span style="color:#f92672">&#39;</span>(lsp-ui-doc-enable <span style="color:#66d9ef">t</span>)
 <span style="color:#f92672">&#39;</span>(lsp-ui-doc-header <span style="color:#66d9ef">t</span>)
 <span style="color:#f92672">&#39;</span>(lsp-ui-doc-include-signature <span style="color:#66d9ef">t</span>)
 <span style="color:#f92672">&#39;</span>(lsp-ui-doc-max-height <span style="color:#ae81ff">30</span>)
 <span style="color:#f92672">&#39;</span>(lsp-ui-doc-max-width <span style="color:#ae81ff">120</span>)
 <span style="color:#f92672">&#39;</span>(lsp-ui-doc-position (quote at-point))
 <span style="color:#f92672">&#39;</span>(lsp-ui-doc-use-childframe <span style="color:#66d9ef">t</span>)

 <span style="color:#75715e">;; If this is true then you can&#39;t see the docs in terminal</span>
 <span style="color:#f92672">&#39;</span>(lsp-ui-doc-use-webkit <span style="color:#66d9ef">nil</span>)
 <span style="color:#f92672">&#39;</span>(lsp-ui-flycheck-enable <span style="color:#66d9ef">t</span>)

 <span style="color:#f92672">&#39;</span>(lsp-ui-imenu-enable <span style="color:#66d9ef">t</span>)
 <span style="color:#f92672">&#39;</span>(lsp-ui-imenu-kind-position (quote top))
 <span style="color:#f92672">&#39;</span>(lsp-ui-peek-enable <span style="color:#66d9ef">t</span>)

 <span style="color:#f92672">&#39;</span>(lsp-ui-peek-fontify <span style="color:#e6db74">&#39;on-demand</span>) <span style="color:#75715e">;; never, on-demand, or always</span>
 <span style="color:#f92672">&#39;</span>(lsp-ui-peek-list-width <span style="color:#ae81ff">50</span>)
 <span style="color:#f92672">&#39;</span>(lsp-ui-peek-peek-height <span style="color:#ae81ff">20</span>)
 <span style="color:#f92672">&#39;</span>(lsp-ui-sideline-code-actions-prefix <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#66d9ef">t</span>)

                                        <span style="color:#75715e">;inline right flush docs</span>
 <span style="color:#f92672">&#39;</span>(lsp-ui-sideline-enable <span style="color:#66d9ef">t</span>)

 <span style="color:#f92672">&#39;</span>(lsp-ui-sideline-ignore-duplicate <span style="color:#66d9ef">t</span>)
 <span style="color:#f92672">&#39;</span>(lsp-ui-sideline-show-code-actions <span style="color:#66d9ef">t</span>)
 <span style="color:#f92672">&#39;</span>(lsp-ui-sideline-show-diagnostics <span style="color:#66d9ef">t</span>)
 <span style="color:#f92672">&#39;</span>(lsp-ui-sideline-show-hover <span style="color:#66d9ef">t</span>)
 <span style="color:#f92672">&#39;</span>(lsp-ui-sideline-show-symbol <span style="color:#66d9ef">t</span>))</code></pre></td></tr></table>
</div>
</div>

<h2 id="handle-dot-el"><code>handle.el</code></h2>

<p>If you want to use <code>handle.el</code> then do something like this.</p>

<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(<span style="color:#a6e22e">define-key</span> prog-mode-map (kbd <span style="color:#e6db74">&#34;M-=&#34;</span>) <span style="color:#e6db74">&#39;handle-repls</span>)
(<span style="color:#a6e22e">define-key</span> prog-mode-map (kbd <span style="color:#e6db74">&#34;M-)&#34;</span>) <span style="color:#e6db74">&#39;handle-assignments</span>)
(<span style="color:#a6e22e">define-key</span> prog-mode-map (kbd <span style="color:#e6db74">&#34;M-*&#34;</span>) <span style="color:#e6db74">&#39;handle-references</span>)
(<span style="color:#a6e22e">define-key</span> prog-mode-map (kbd <span style="color:#e6db74">&#34;M-^&#34;</span>) <span style="color:#e6db74">&#39;handle-errors</span>)
<span style="color:#75715e">;; This is reserved</span>
(<span style="color:#a6e22e">define-key</span> prog-mode-map (kbd <span style="color:#e6db74">&#34;M-+&#34;</span>) <span style="color:#66d9ef">nil</span>)
(<span style="color:#a6e22e">define-key</span> prog-mode-map (kbd <span style="color:#e6db74">&#34;M-_&#34;</span>) <span style="color:#66d9ef">nil</span>)
(<span style="color:#a6e22e">define-key</span> prog-mode-map (kbd <span style="color:#e6db74">&#34;M-9&#34;</span>) <span style="color:#e6db74">&#39;handle-docs</span>)
(<span style="color:#a6e22e">define-key</span> prog-mode-map (kbd <span style="color:#e6db74">&#34;M-.&#34;</span>) <span style="color:#e6db74">&#39;handle-godef</span>)

(<span style="color:#a6e22e">define-key</span> prog-mode-map (kbd <span style="color:#e6db74">&#34;M-p&#34;</span>) <span style="color:#e6db74">&#39;handle-prevdef</span>)
(<span style="color:#a6e22e">define-key</span> prog-mode-map (kbd <span style="color:#e6db74">&#34;M-n&#34;</span>) <span style="color:#e6db74">&#39;handle-nextdef</span>)

(<span style="color:#a6e22e">define-key</span> prog-mode-map (kbd <span style="color:#e6db74">&#34;M-P&#34;</span>) <span style="color:#e6db74">&#39;handle-preverr</span>)
(<span style="color:#a6e22e">define-key</span> prog-mode-map (kbd <span style="color:#e6db74">&#34;M-N&#34;</span>) <span style="color:#e6db74">&#39;handle-nexterr</span>)

(<span style="color:#a6e22e">define-key</span> prog-mode-map (kbd <span style="color:#e6db74">&#34;M-l M-j M-w&#34;</span>) <span style="color:#e6db74">&#39;handle-spellcorrect</span>)</code></pre></td></tr></table>
</div>
</div>

<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(handle <span style="color:#f92672">&#39;</span>(prog-mode)
        :complete <span style="color:#f92672">&#39;</span>(indent-for-tab-command)
        :repls <span style="color:#f92672">&#39;</span>()
        :formatters <span style="color:#f92672">&#39;</span>(lsp-format-buffer)
        :docs <span style="color:#f92672">&#39;</span>(
                <span style="color:#75715e">;; lsp-ui-doc-show</span>
                my/doc-thing-at-point)
        :docsearch <span style="color:#f92672">&#39;</span>(my/doc-ask)
        :godec <span style="color:#f92672">&#39;</span>(lsp-find-declaration)
        :godef <span style="color:#f92672">&#39;</span>(lsp-find-definition
                 xref-find-definitions
                 helm-gtags-dwim)
        :nextdef <span style="color:#f92672">&#39;</span>(my-prog-next-def)
        :prevdef <span style="color:#f92672">&#39;</span>(my-prog-prev-def)
        :nexterr <span style="color:#f92672">&#39;</span>(flycheck-next-error)
        :preverr <span style="color:#f92672">&#39;</span>(flycheck-previous-error)
        <span style="color:#75715e">;; select from multiple</span>
        :errors <span style="color:#f92672">&#39;</span>(lsp-ui-flycheck-list)
        :assignments <span style="color:#f92672">&#39;</span>()
        :references <span style="color:#f92672">&#39;</span>(lsp-ui-peek-find-references)
        :definitions <span style="color:#f92672">&#39;</span>(lsp-ui-peek-find-definitions)
        :implementations <span style="color:#f92672">&#39;</span>(lsp-ui-peek-find-implementation))</code></pre></td></tr></table>
</div>
</div>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>